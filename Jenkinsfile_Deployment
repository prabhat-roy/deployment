pipeline {
    agent any
    stages {
        stage('Cleanup Workspace') {
            steps {
                script {
                    echo "[INFO] Cleaning up the workspace..."
                    // Load the cleanup script and execute it
                    def cleanup = load 'groovy/cleanup.groovy'
                    cleanup.cleanupWorkspace() // Assuming this handles workspace cleanup
                    echo "[INFO] Workspace cleaned successfully."
                }
            }
        
        }
        stage('Git Checkout') {
            steps {
                script {
                    echo "[INFO] Performing fresh Git checkout..."

                    // Ensure a fresh Git checkout after cleanup
                    checkout([$class: 'GitSCM',
                              branches: [[name: "*/${env.BRANCH}"]],
                              userRemoteConfigs: [[url: env.GITHUB_URL]]])

                    echo "[INFO] Git checkout completed."
                }
            }
        }
    }
}