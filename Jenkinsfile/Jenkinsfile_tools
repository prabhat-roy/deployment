pipeline {
    agent any

    environment {
        ENV_FILE_PATH = 'groovy/Deployment.env'
    }

    stages {
        stage('Load Environment Variables') {
            steps {
                script {
                    def envVars = load('groovy/LoadEnvVars.groovy').call(ENV_FILE_PATH)
                    envVars.each { key, value -> env[key] = value }
                }
            }
        }

        stage('Cleanup Workspace') {
            steps {
                script {
                    def cleanupScript = load 'groovy/Cleanup.groovy'
                    cleanupScript.setupWorkspace()
                }
            }
        }

        
        

	}


    post {
        always {
            script {
                echo "Pipeline finished for action: ${params.ACTION}"
            }
        }
    }
}
