pipeline {
    agent any
    parameters {
        choice(
            name: 'ACTION',
            choices: ['create', 'destroy'], 
            description: 'Choose whether to create or destroy kubernetes resources.'
        )
    }
    stages {
        stage('Git Checkout') {
            steps {
                script {
                    checkout scm
                    }
                }
            }
            stage('Load Environment Variables') {
                steps {
                    script {
                        copyArtifacts projectName: 'tools', filter: 'Jenkins.env', target: './'  
                        def props = readProperties file: 'Jenkins.env'
                        props.each { k, v ->
                            env."${k}" = v                     
                        }
                    }
                }
            }
            stage('Create Cloud Repositories') {
                steps {
                    script {
                        def repoCreator = load 'groovy/cloud_repo.groovy'
                        repoCreator.createCloudRepo(params.ACTION)
                    }
                }
            }
            // stage('Create Docker Images') {
            //     steps {
            //         script {
            //             def dockerBuild = load 'groovy/docker_build.groovy'
            //             dockerBuild.createDockerBuild()
            //         }
            //     }
            // }
    }
}

        
