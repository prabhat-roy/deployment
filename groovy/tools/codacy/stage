stage('Codacy') {
    steps {
        script {
            load 'groovy/tools/codacy/loadEnvVars.groovy'
            loadEnvVars()

            load 'groovy/tools/codacy/runCodacyScan.groovy'
            runCodacyScan('codacy_project_token') // Jenkins credentialsId

            load 'groovy/tools/codacy/generateReport.groovy'
            generateReport()

            load 'groovy/tools/codacy/archiveReport.groovy'
            archiveReport()

            load 'groovy/tools/codacy/cleanUp.groovy'
            cleanUp()
        }
    }
}
